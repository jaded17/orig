 <div class="content-wrapper">
      <button class="add-btn" (click)="openAddModal()">Add User</button>

      <div class="table-container">
        <h2 class="table-title">User List</h2>

        <!-- Loading Spinner -->
        <div *ngIf="loading" class="loading-container">
          <div class="spinner"></div>
          <p>Loading users...</p>
        </div>

        <!-- Error Message -->
        <div *ngIf="error" class="error-message">
          <p>{{ error }}</p>
          <button (click)="loadUsers()">Retry</button>
        </div>

        <!-- Table (only show when not loading) -->
        <div *ngIf="!loading && !error">
          <div class="table-controls">
            <div class="table-info">
              <span>Show</span>
              <select [(ngModel)]="entriesPerPage" class="entries-select">
                <option [value]="100">100</option>
                <option [value]="50">50</option>
                <option [value]="25">25</option>
              </select>
              <span>entries</span>
            </div>

            <div class="table-actions">
              <button class="control-btn delete-btn" 
                      [disabled]="!hasSelected()"
                      (click)="bulkDelete()">
                Delete selected
              </button>
            </div>
          </div>

          <div class="search-container">
            <label>Search:</label>
            <input type="search" [(ngModel)]="searchTerm" placeholder="Search users..." class="search-input">
          </div>

          <table class="data-table">
            <thead>
              <tr>
                <th><input type="checkbox" (change)="toggleAll($event)" [checked]="allSelected()"></th>
                <th>ID ↕</th>
                <th>Name ↕</th>
                <th>Email ↕</th>
                <th>Role ↕</th>
                <th>Status ↕</th>
                <th>Created At ↕</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of filteredUsers()">
                <td><input type="checkbox" [(ngModel)]="user.selected"></td>
                <td>{{ user.id }}</td>
                <td>{{ user.name }}</td>
                <td>{{ user.email }}</td>
                <td><span class="role-badge">{{ user.role }}</span></td>
                <td><span class="status-badge" [ngClass]="user.status">{{ user.status }}</span></td>
                <td>{{ user.created_at }}</td>
                <td class="actions-cell">
                  <button class="action-btn view-btn" (click)="openViewModal(user)">View</button>
                  <button class="action-btn edit-btn" (click)="openEditModal(user)">Edit</button>
                  <button class="action-btn delete-btn" (click)="openDeleteModal(user)">Delete</button>
                </td>
              </tr>
            </tbody>
          </table>

          <div class="table-footer">
            <span class="showing-text">Showing 1 to {{ users.length }} of {{ users.length }} entries</span>
            <div class="pagination">
              <button class="page-btn" disabled>Previous</button>
              <button class="page-btn active">1</button>
              <button class="page-btn" disabled>Next</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ADD USER MODAL -->
    <div class="modal-overlay" *ngIf="showAddModal" (click)="closeAddModal()">
      <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Add New User</h2>
          <button class="close-btn" (click)="closeAddModal()">×</button>
        </div>
        <div class="modal-body">
          <p class="modal-subtitle">Create a new user account</p>
          
          <form [formGroup]="addUserForm">
            <div class="form-group">
              <label>Full Name *</label>
              <input 
                type="text" 
                formControlName="name"
                placeholder="Enter full name"
                class="form-input"
                [class.error]="addUserForm.get('name')?.invalid && addUserForm.get('name')?.touched">
              <span class="error-text" *ngIf="addUserForm.get('name')?.invalid && addUserForm.get('name')?.touched">
                Name is required (min 3 characters)
              </span>
            </div>

            <div class="form-group">
              <label>Email Address *</label>
              <input 
                type="email" 
                formControlName="email"
                placeholder="user@example.com"
                class="form-input"
                [class.error]="addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched">
              <span class="error-text" *ngIf="addUserForm.get('email')?.invalid && addUserForm.get('email')?.touched">
                Valid email is required
              </span>
            </div>

            <div class="form-group">
              <label>Password *</label>
              <input 
                type="password" 
                formControlName="password"
                placeholder="Minimum 8 characters"
                class="form-input"
                [class.error]="addUserForm.get('password')?.invalid && addUserForm.get('password')?.touched">
              <span class="error-text" *ngIf="addUserForm.get('password')?.invalid && addUserForm.get('password')?.touched">
                Password must be at least 8 characters
              </span>
            </div>

            <div class="form-group">
              <label>Role *</label>
              <select 
                formControlName="role"
                class="form-input"
                [class.error]="addUserForm.get('role')?.invalid && addUserForm.get('role')?.touched">
                <option value="">Select role</option>
                <option value="PM">Project Manager</option>
                <option value="Members">Members</option>
                <option value="Client">Client</option>
              </select>
              <span class="error-text" *ngIf="addUserForm.get('role')?.invalid && addUserForm.get('role')?.touched">
                Please select a role
              </span>
            </div>

            <div class="form-group">
              <label>Status *</label>
              <select formControlName="status" class="form-input">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn-cancel" (click)="closeAddModal()">Cancel</button>
          <button class="btn-submit" 
                  [disabled]="addUserForm.invalid || submitting"
                  (click)="addUser()">
            {{ submitting ? 'Creating...' : 'Create User' }}
          </button>
        </div>
      </div>
    </div>

    <!-- VIEW USER MODAL -->
    <div class="modal-overlay" *ngIf="showViewModal" (click)="closeViewModal()">
      <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>User Details</h2>
          <button class="close-btn" (click)="closeViewModal()">×</button>
        </div>
        <div class="modal-body">
          <div class="detail-item">
            <label>ID</label>
            <p>{{ selectedUser?.id }}</p>
          </div>

          <div class="detail-item">
            <label>Name</label>
            <p>{{ selectedUser?.name }}</p>
          </div>

          <div class="detail-item">
            <label>Email</label>
            <p>{{ selectedUser?.email }}</p>
          </div>

          <div class="detail-item">
            <label>Role</label>
            <p><span class="role-badge">{{ selectedUser?.role }}</span></p>
          </div>

          <div class="detail-item">
            <label>Status</label>
            <p><span class="status-badge" [ngClass]="selectedUser?.status">{{ selectedUser?.status }}</span></p>
          </div>

          <div class="detail-item">
            <label>Created At</label>
            <p>{{ selectedUser?.created_at }}</p>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn-cancel" (click)="closeViewModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- EDIT USER MODAL -->
    <div class="modal-overlay" *ngIf="showEditModal" (click)="closeEditModal()">
      <div class="modal" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Edit User</h2>
          <button class="close-btn" (click)="closeEditModal()">×</button>
        </div>
        <div class="modal-body">
          <p class="modal-subtitle">Update user information</p>
          
          <form [formGroup]="editUserForm">
            <div class="form-group">
              <label>Full Name *</label>
              <input 
                type="text" 
                formControlName="name"
                class="form-input"
                [class.error]="editUserForm.get('name')?.invalid && editUserForm.get('name')?.touched">
              <span class="error-text" *ngIf="editUserForm.get('name')?.invalid && editUserForm.get('name')?.touched">
                Name is required (min 3 characters)
              </span>
            </div>

            <div class="form-group">
              <label>Email Address *</label>
              <input 
                type="email" 
                formControlName="email"
                class="form-input"
                [class.error]="editUserForm.get('email')?.invalid && editUserForm.get('email')?.touched">
              <span class="error-text" *ngIf="editUserForm.get('email')?.invalid && editUserForm.get('email')?.touched">
                Valid email is required
              </span>
            </div>

            <div class="form-group">
              <label>Role *</label>
              <select formControlName="role" class="form-input">
                <option value="PM">Project Manager</option>
                <option value="Members">Members</option>
                <option value="Client">Client</option>
              </select>
            </div>

            <div class="form-group">
              <label>Status *</label>
              <select formControlName="status" class="form-input">
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn-cancel" (click)="closeEditModal()">Cancel</button>
          <button class="btn-submit" 
                  [disabled]="editUserForm.invalid || submitting"
                  (click)="updateUser()">
            {{ submitting ? 'Updating...' : 'Update User' }}
          </button>
        </div>
      </div>
    </div>

    <!-- DELETE CONFIRMATION MODAL -->
    <div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeDeleteModal()">
      <div class="modal modal-small" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Delete User?</h2>
          <button class="close-btn" (click)="closeDeleteModal()">×</button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete <strong>{{ selectedUser?.name }}</strong>?</p>
          <p class="warning-text">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button class="btn-cancel" (click)="closeDeleteModal()">Cancel</button>
          <button class="btn-delete" 
                  [disabled]="submitting"
                  (click)="confirmDelete()">
            {{ submitting ? 'Deleting...' : 'Delete' }}
          </button>
        </div>
      </div>
    </div>